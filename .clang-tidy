# clang-tidy configuration for ex_vrp
# Focused on catching bugs and performance issues in the PyVRP-derived code

Checks: >
  -*,
  bugprone-*,
  -bugprone-easily-swappable-parameters,
  -bugprone-exception-escape,
  clang-analyzer-*,
  -clang-analyzer-cplusplus.NewDeleteLeaks,
  concurrency-*,
  cppcoreguidelines-init-variables,
  cppcoreguidelines-pro-type-member-init,
  cppcoreguidelines-slicing,
  misc-redundant-expression,
  misc-unused-parameters,
  modernize-use-nullptr,
  modernize-use-override,
  performance-*,
  -performance-avoid-endl,
  readability-container-size-empty,
  readability-duplicate-include,
  readability-redundant-smartptr-get,

WarningsAsErrors: ""

HeaderFilterRegex: "c_src/.*"

CheckOptions:
  # Allow C-style casts in low-level code
  - key: bugprone-suspicious-include.HeaderFileExtensions
    value: ";h;hh;hpp;hxx"
  # Performance tuning
  - key: performance-unnecessary-value-param.AllowedTypes
    value: "std::function"
  # Don't flag small trivially-copyable types
  - key: performance-for-range-copy.WarnOnAllAutoCopies
    value: false
  - key: performance-unnecessary-copy-initialization.AllowedTypes
    value: ""

# Extra args needed to find headers
# These will be passed when running clang-tidy
ExtraArgsBefore:
  - "-std=c++20"
  - "-I"
  - "c_src"
  - "-I"
  - "c_src/pyvrp"
